(this.webpackJsonpmaxwell=this.webpackJsonpmaxwell||[]).push([[0],{184:function(e,t,a){"use strict";a.r(t);var i=a(6),n=a.n(i),r=a(73),c=a.n(r),l=(a(81),a(35)),s=a.n(l),u=a(74),o=a(12),d=a(20),h=a(75);function g(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=[],i=0;i<e[0]*e[1]*e[2];i++)a.push(t);return{values:a,shape:e}}function p(e,t,a,i,n){e.values[t+a*e.shape[0]+i*e.shape[0]*e.shape[1]]=n}function v(e,t,a,i,n){e.values[t+a*e.shape[0]+i*e.shape[0]*e.shape[1]]+=n}var m=[window.innerWidth,window.innerHeight],f=m[0]/m[1],b=m[0]>=m[1]?[600,Math.ceil(600/f),1]:[Math.ceil(600*f),600,1],S=new function e(t,a){var i=this;Object(h.a)(this,e),this.data=void 0,this.gpu=void 0,this.updateMagneticX=void 0,this.updateMagneticY=void 0,this.updateMagneticZ=void 0,this.updateElectricX=void 0,this.updateElectricY=void 0,this.updateElectricZ=void 0,this.stepElectric=function(e){var t=i.data.electricFieldX.values,a=i.data.electricFieldY.values,n=i.data.electricFieldZ.values,r=i.data.magneticFieldX.values,c=i.data.magneticFieldY.values,l=i.data.magneticFieldZ.values,s=i.data.permittivity.values;i.data.electricFieldX.values=i.updateElectricX(c,l,s,t,e),i.data.electricFieldY.values=i.updateElectricY(r,l,s,a,e),i.data.electricFieldZ.values=i.updateElectricZ(r,c,s,n,e),i.data.time+=e/2},this.stepMagnetic=function(e){var t=i.data.electricFieldX.values,a=i.data.electricFieldY.values,n=i.data.electricFieldZ.values,r=i.data.magneticFieldX.values,c=i.data.magneticFieldY.values,l=i.data.magneticFieldZ.values,s=i.data.permeability.values;i.data.magneticFieldX.values=i.updateMagneticX(a,n,s,r,e),i.data.magneticFieldY.values=i.updateMagneticY(t,n,s,c,e),i.data.magneticFieldZ.values=i.updateMagneticZ(t,a,s,l,e),i.data.time+=e/2},this.resetFields=function(){i.data.time=0;for(var e=0;e<i.data.electricFieldX.values.length;e++)i.data.electricFieldX.values[e]=0,i.data.electricFieldY.values[e]=0,i.data.electricFieldZ.values[e]=0,i.data.magneticFieldX.values[e]=0,i.data.magneticFieldY.values[e]=0,i.data.magneticFieldZ.values[e]=0},this.resetMaterials=function(){for(var e=0;e<i.data.permeability.values.length;e++)i.data.permeability.values[e]=1,i.data.permittivity.values[e]=1},this.getData=function(){return i.data},this.data={time:0,electricFieldX:g(t),electricFieldY:g(t),electricFieldZ:g(t),magneticFieldX:g(t),magneticFieldY:g(t),magneticFieldZ:g(t),permittivity:g(t,1),permeability:g(t,1)};var n=t[0]*t[1]*t[2];function r(e,t,a,i,n,r,c){return n<0||n>=t||r<0||r>=a||c<0||c>=i?0:e[n+r*t+c*t*i]}function c(e,t){return e%t}function l(e,t,a){return Math.floor(e/t)%a}function s(e,t,a,i){return Math.floor(e/(t*a))%i}this.gpu=new d.GPU,this.updateMagneticX=this.gpu.createKernel((function(e,t,a,i,n){var u=Math.floor(this.thread.x),o=this.constants.gridSizeX,d=this.constants.gridSizeY,h=this.constants.gridSizeZ,g=this.constants.cellSize,p=c(u,o),v=l(u,o,d),m=s(u,o,d,h);return r(i,o,d,h,p,v,m)-n/(r(a,o,d,h,p,v,m)*g)*(r(t,o,d,h,p,v+1,m)-r(t,o,d,h,p,v,m))}),{output:[n],constants:{cellSize:a,gridSizeX:t[0],gridSizeY:t[1],gridSizeZ:t[2]}}).setFunctions([c,l,s,r]).setWarnVarUsage(!1),this.updateMagneticY=this.gpu.createKernel((function(e,t,a,i,n){var u=Math.floor(this.thread.x),o=this.constants.gridSizeX,d=this.constants.gridSizeY,h=this.constants.gridSizeZ,g=this.constants.cellSize,p=c(u,o),v=l(u,o,d),m=s(u,o,d,h);return r(i,o,d,h,p,v,m)-n/(r(a,o,d,h,p,v,m)*g)*-(r(t,o,d,h,p+1,v,m)-r(t,o,d,h,p,v,m))}),{output:[n],constants:{cellSize:a,gridSizeX:t[0],gridSizeY:t[1],gridSizeZ:t[2]}}).setFunctions([c,l,s,r]).setWarnVarUsage(!1),this.updateMagneticZ=this.gpu.createKernel((function(e,t,a,i,n){var u=Math.floor(this.thread.x),o=this.constants.gridSizeX,d=this.constants.gridSizeY,h=this.constants.gridSizeZ,g=this.constants.cellSize,p=c(u,o),v=l(u,o,d),m=s(u,o,d,h);return r(i,o,d,h,p,v,m)-n/(r(a,o,d,h,p,v,m)*g)*(r(t,o,d,h,p+1,v,m)-r(t,o,d,h,p,v,m)-(r(e,o,d,h,p,v+1,m)-r(e,o,d,h,p,v,m)))}),{output:[n],constants:{cellSize:a,gridSizeX:t[0],gridSizeY:t[1],gridSizeZ:t[2]}}).setFunctions([c,l,s,r]).setWarnVarUsage(!1),this.updateElectricX=this.gpu.createKernel((function(e,t,a,i,n){var u=Math.floor(this.thread.x),o=this.constants.gridSizeX,d=this.constants.gridSizeY,h=this.constants.gridSizeZ,g=this.constants.cellSize,p=c(u,o),v=l(u,o,d),m=s(u,o,d,h);return r(i,o,d,h,p,v,m)+n/(r(a,o,d,h,p,v,m)*g)*(r(t,o,d,h,p,v,m)-r(t,o,d,h,p,v-1,m))}),{output:[n],constants:{cellSize:a,gridSizeX:t[0],gridSizeY:t[1],gridSizeZ:t[2]}}).setFunctions([c,l,s,r]).setWarnVarUsage(!1),this.updateElectricY=this.gpu.createKernel((function(e,t,a,i,n){var u=Math.floor(this.thread.x),o=this.constants.gridSizeX,d=this.constants.gridSizeY,h=this.constants.gridSizeZ,g=this.constants.cellSize,p=c(u,o),v=l(u,o,d),m=s(u,o,d,h);return r(i,o,d,h,p,v,m)+n/(r(a,o,d,h,p,v,m)*g)*-(r(t,o,d,h,p,v,m)-r(t,o,d,h,p-1,v,m))}),{output:[n],constants:{cellSize:a,gridSizeX:t[0],gridSizeY:t[1],gridSizeZ:t[2]}}).setFunctions([c,l,s,r]).setWarnVarUsage(!1),this.updateElectricZ=this.gpu.createKernel((function(e,t,a,i,n){var u=Math.floor(this.thread.x),o=this.constants.gridSizeX,d=this.constants.gridSizeY,h=this.constants.gridSizeZ,g=this.constants.cellSize,p=c(u,o),v=l(u,o,d),m=s(u,o,d,h);return r(i,o,d,h,p,v,m)+n/(r(a,o,d,h,p,v,m)*g)*(r(t,o,d,h,p,v,m)-r(t,o,d,h,p-1,v,m)-(r(e,o,d,h,p,v,m)-r(e,o,d,h,p,v-1,m)))}),{output:[n],constants:{cellSize:a,gridSizeX:t[0],gridSizeY:t[1],gridSizeZ:t[2]}}).setFunctions([c,l,s,r]).setWarnVarUsage(!1)}(b,.04);function z(e,t,a){return Math.max(e,Math.min(t,a))}function F(e){return n.a.createElement("div",null,n.a.createElement("label",null,e.label),n.a.createElement("div",null,n.a.createElement("input",{type:"range",min:e.min,max:e.max,value:e.value,step:e.step,onChange:function(t){return e.setValue(parseFloat(t.target.value))},style:{height:10,width:"100%"}}),n.a.createElement("div",{style:{textAlign:"center",lineHeight:.1,marginBottom:"7px"}},e.value)))}function M(e){return n.a.createElement("div",null,e.options.map((function(t,a){return n.a.createElement("button",{key:t,style:{boxSizing:"border-box",border:a===e.selectedOption?"4px solid rgb(0, 150, 255)":"0",height:"30px",margin:"5px",width:"".concat(100/e.options.length,"%"),background:"rgb(100, 100, 100)",color:"white"},onClick:function(t){return e.setSelectedOption(a)}},t)})))}function X(e){var t=Object(i.useState)(!1),a=Object(o.a)(t,2),r=a[0],c=a[1];return n.a.createElement("div",{style:{userSelect:"none"}},n.a.createElement("div",{style:{textAlign:"center",position:"absolute",opacity:.8,background:"rgba(33, 33, 33, 100)",fontWeight:"lighter",color:"white"}},n.a.createElement("button",{onClick:function(e){return c(!r)},style:{width:"100%",height:"30px",background:"rgba(50, 50, 50, 100)",border:"0px",color:"white",fontWeight:"bold",cursor:"pointer"}},"Controls [",r?"+":"-","]"),!r&&n.a.createElement("div",{style:{padding:"10px"}},n.a.createElement(F,{label:"Brush size",value:e.brushSize,setValue:e.setBrushSize,min:0,max:100,step:1}),n.a.createElement(F,{label:"Brush value",value:e.brushValue,setValue:e.setBrushValue,min:1,max:100,step:1}),n.a.createElement(F,{label:"Signal frequency",value:e.signalFrequency,setValue:e.setSignalFrequency,min:.5,max:5,step:.5}),n.a.createElement(M,{options:["\u03b5 brush","\xb5 brush","Signal"],selectedOption:e.clickOption,setSelectedOption:e.setClickOption}),n.a.createElement("button",{onClick:e.resetFields,style:{background:"rgba(50, 50, 50, 100)",border:"0px",color:"white",margin:"2px"}},"Reset fields"),n.a.createElement("button",{onClick:e.resetMaterials,style:{background:"rgba(50, 50, 50, 100)",border:"0px",color:"white",margin:"2px"}},"Reset materials"))))}var x=null,E=0,y=[0,0],O=null;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(n.a.createElement((function(){var e=Object(i.useState)(5),t=Object(o.a)(e,2),a=t[0],r=t[1],c=Object(i.useState)(5),l=Object(o.a)(c,2),h=l[0],g=l[1],f=Object(i.useState)(1),F=Object(o.a)(f,2),M=F[0],Y=F[1],w=Object(i.useState)(!1),Z=Object(o.a)(w,2),j=Z[0],k=Z[1],C=Object(i.useState)(!1),V=Object(o.a)(C,2),W=V[0],D=V[1],U=Object(i.useState)(2),B=Object(o.a)(U,2),K=B[0],q=B[1],I=Object(i.useRef)(null),P=Object(i.useCallback)((function(){var e=S.getData();if(null!==O&&(y=O,E=Math.min(1e4,E+200)),(E*=Math.pow(.1,.02))>1&&I.current)for(var t=z(0,e.electricFieldX.shape[0]-1,Math.floor(e.electricFieldX.shape[0]*y[0]/I.current.width)),a=z(0,e.electricFieldX.shape[1]-1,Math.floor(e.electricFieldX.shape[1]*y[1]/I.current.height)),i=0;i<e.electricFieldX.shape[2];i++)v(e.electricFieldZ,t,a,i,Math.sin(2*M*Math.PI*e.time)*E*.02);S.stepMagnetic(.02),S.stepElectric(.02)}),[M]);Object(i.useEffect)((function(){var e=setInterval(P,20);return function(){return clearInterval(e)}}),[P]);var R=Object(i.useCallback)((function(){var e=!1;return function(){var t=Object(u.a)(s.a.mark((function t(){var a,i;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=function(e){return requestAnimationFrame(e)};case 1:if(e){t.next=8;break}return(i=S.getData()).time>0&&null!==x&&x(i.electricFieldX.values,i.electricFieldY.values,i.electricFieldZ.values,i.magneticFieldX.values,i.magneticFieldY.values,i.magneticFieldZ.values,i.permittivity.values,i.permeability.values),t.next=6,new Promise(a);case 6:t.next=1;break;case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()(),function(){e=!0}}),[]);Object(i.useEffect)((function(){if(!I.current)throw new Error("Canvas ref was null");x=function(e){function t(e,t,a,i,n,r,c){return n<0||n>=t||r<0||r>=a||c<0||c>=i?0:e[n+r*t+c*t*i]}return e.createKernel((function(e,a,i,n,r,c,l,s){var u=this.constants.gridSizeX,o=this.constants.gridSizeY,d=this.constants.gridSizeZ,h=u*this.thread.x/this.output.x,g=o*(1-this.thread.y/this.output.y),p=Math.floor(h),v=Math.floor(g),m=Math.floor(d/2),f=t(e,u,o,d,p,v,m)*t(e,u,o,d,p,v,m)+t(a,u,o,d,p,v,m)*t(a,u,o,d,p,v,m)+t(i,u,o,d,p,v,m)*t(i,u,o,d,p,v,m),b=(t(n,u,o,d,p,v,m)+t(n,u,o,d,p-1,v-1,m))/2,S=(t(r,u,o,d,p,v,m)+t(r,u,o,d,p-1,v-1,m))/2,z=(t(c,u,o,d,p,v,m)+t(c,u,o,d,p-1,v-1,m))/2,F=b*b+S*S+z*z,M=Math.max(0,Math.min(1,(1+.4342944819*Math.log(t(l,u,o,d,p,v,m)))/4)),X=Math.max(0,Math.min(1,(1+.4342944819*Math.log(t(s,u,o,d,p,v,m)))/4)),x=(Math.abs(h%1-.5)<.25?1:0)*(Math.abs(g%1-.5)<.25?1:0),E=1-x;this.color(f/15+.5*x*M,f/15+F/15,F/15+.5*E*X)}),{output:[m[0],m[1]],constants:{gridSizeX:b[0],gridSizeY:b[1],gridSizeZ:b[2]},graphical:!0}).setFunctions([t]).setWarnVarUsage(!1)}(new d.GPU({mode:"webgl2",canvas:I.current})),R()}),[R]);var A=Object(i.useCallback)((function(e,t){for(var i=Math.round(b[0]*(t[0]/m[0])),n=Math.round(b[1]*(t[1]/m[1])),r=Math.round(a/2),c=Math.max(0,i-r);c<=Math.min(b[0]-1,i+r);c++)for(var l=Math.max(0,n-r);l<=Math.min(b[1]-1,n+r);l++)p(e,c,l,0,h)}),[a,h]),T=Object(i.useCallback)((function(){S.resetMaterials()}),[]),G=Object(i.useCallback)((function(){S.resetFields(),E=0}),[]),H=Object(i.useCallback)((function(e){var t=Object(o.a)(e,2),a=t[0],i=t[1];2===K?O=[a,i]:0===K?(A(S.getData().permittivity,[a,i]),D(!0)):1===K&&(A(S.getData().permeability,[a,i]),k(!0))}),[A,K]),J=Object(i.useCallback)((function(e){var t=Object(o.a)(e,2),a=t[0],i=t[1];2===K&&null!==O&&(O=[a,i]),W&&A(S.getData().permittivity,[a,i]),j&&A(S.getData().permeability,[a,i])}),[A,K,j,W]),$=Object(i.useCallback)((function(e){var t=Object(o.a)(e,2);t[0],t[1];2===K?O=null:1===K?k(!1):0===K&&D(!1)}),[K]);return n.a.createElement("div",null,n.a.createElement("canvas",{width:m[0],height:m[1],ref:I,style:{position:"absolute"},onMouseDown:function(e){return H([e.clientX,e.clientY])},onMouseMove:function(e){return J([e.clientX,e.clientY])},onMouseUp:function(e){return $([e.clientX,e.clientY])},onTouchStart:function(e){return H([e.touches[0].clientX,e.touches[0].clientY])},onTouchMove:function(e){return J([e.touches[0].clientX,e.touches[0].clientY])},onTouchEnd:function(e){return $([e.touches[0].clientX,e.touches[0].clientY])},onContextMenu:function(e){return e.preventDefault()}}),n.a.createElement("div",{style:{position:"absolute",bottom:10,right:10,userSelect:"none"}},n.a.createElement("a",{href:"https://github.com/RobinKa/maxwell-simulation",rel:"noopener noreferrer",target:"_blank",style:{fontWeight:"lighter",color:"rgba(255, 255, 255, 100)",textDecoration:"none"}},"Source code")),n.a.createElement(X,{brushSize:a,setBrushSize:r,brushValue:h,setBrushValue:g,signalFrequency:M,setSignalFrequency:Y,clickOption:K,setClickOption:q,resetFields:G,resetMaterials:T}))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},76:function(e,t,a){e.exports=a(184)},81:function(e,t,a){}},[[76,1,2]]]);
//# sourceMappingURL=main.85d89f88.chunk.js.map