(this.webpackJsonpmaxwell=this.webpackJsonpmaxwell||[]).push([[0],{183:function(e,t,i){},184:function(e,t,i){"use strict";i.r(t);var r=i(0),a=i.n(r),n=i(74),l=i.n(n),u=(i(81),i(7)),c=i(14),o=i(21),s=i(22);function d(e,t,i,r,a){return r<0||r>=t||a<0||a>=i?0:e[a][r]}function p(e){return e}function h(e){return e[this.thread.y][this.thread.x]}function m(e,t,i,r,a){var n=this.thread.x,l=this.thread.y,u=d(a,this.output.x,this.output.y,n,l);return Math.max(Math.abs(e[0]-n),Math.abs(e[1]-l))<t?i+r*u:u}function f(e,t,i,r,a){var n=this.thread.x,l=this.thread.y,u=d(a,this.output.x,this.output.y,n,l),c=e[0]-n,o=e[1]-l;return c*c+o*o<t*t?i+r*u:u}function b(e,t,i){var r=this.thread.x,a=this.thread.y,n=this.output.x,l=this.output.y;return d(t,n,l,r,a)+d(e,n,l,r,a)*i}function g(e,t){var i=this.thread.x,r=this.thread.y;return d(e,this.output.x,this.output.y,i,r)*Math.pow(.1,t)}function v(e,t,i,r,a,n,l){var u=this.thread.x,c=this.thread.y,o=this.output.x,s=this.output.y;if(!l){var p=u<2?1:0,h=u+2>=o?-1:0,m=c<2?1:0,f=c+2>=s?-1:0;if(0!==p||0!==h||0!==m||0!==f)return r[c+m+f][u+p+h]}return d(r,o,s,u,c)-a/(d(i,o,s,u,c)*n)*(d(t,o,s,u,c+1)-d(t,o,s,u,c))}function y(e,t,i,r,a,n,l){var u=this.thread.x,c=this.thread.y,o=this.output.x,s=this.output.y;if(!l){var p=u<2?1:0,h=u+2>=o?-1:0,m=c<2?1:0,f=c+2>=s?-1:0;if(0!==p||0!==h||0!==m||0!==f)return r[c+m+f][u+p+h]}return d(r,o,s,u,c)-a/(d(i,o,s,u,c)*n)*-(d(t,o,s,u+1,c)-d(t,o,s,u,c))}function S(e,t,i,r,a,n,l){var u=this.thread.x,c=this.thread.y,o=this.output.x,s=this.output.y;if(!l){var p=u<2?1:0,h=u+2>=o?-1:0,m=c<2?1:0,f=c+2>=s?-1:0;if(0!==p||0!==h||0!==m||0!==f)return r[c+m+f][u+p+h]}return d(r,o,s,u,c)-a/(d(i,o,s,u,c)*n)*(d(t,o,s,u+1,c)-d(t,o,s,u,c)-(d(e,o,s,u,c+1)-d(e,o,s,u,c)))}function O(e,t,i,r,a,n,l){var u=this.thread.x,c=this.thread.y,o=this.output.x,s=this.output.y;if(!l){var p=u<2?1:0,h=u+2>=o?-1:0,m=c<2?1:0,f=c+2>=s?-1:0;if(0!==p||0!==h||0!==m||0!==f)return r[c+m+f][u+p+h]}return d(r,o,s,u,c)+a/(d(i,o,s,u,c)*n)*(d(t,o,s,u,c)-d(t,o,s,u,c-1))}function x(e,t,i,r,a,n,l){var u=this.thread.x,c=this.thread.y,o=this.output.x,s=this.output.y;if(!l){var p=u<2?1:0,h=u+2>=o?-1:0,m=c<2?1:0,f=c+2>=s?-1:0;if(0!==p||0!==h||0!==m||0!==f)return r[c+m+f][u+p+h]}return d(r,o,s,u,c)+a/(d(i,o,s,u,c)*n)*-(d(t,o,s,u,c)-d(t,o,s,u-1,c))}function w(e,t,i,r,a,n,l){var u=this.thread.x,c=this.thread.y,o=this.output.x,s=this.output.y;if(!l){var p=u<2?1:0,h=u+2>=o?-1:0,m=c<2?1:0,f=c+2>=s?-1:0;if(0!==p||0!==h||0!==m||0!==f)return r[c+m+f][u+p+h]}return d(r,o,s,u,c)+a/(d(i,o,s,u,c)*n)*(d(t,o,s,u,c)-d(t,o,s,u-1,c)-(d(e,o,s,u,c)-d(e,o,s,u,c-1)))}function j(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function M(e,t,i){return{drawShape:"square",center:e,halfSize:t,value:i}}function E(e,t,i){return{drawShape:"circle",center:e,radius:t,value:i}}function z(e){var t={};return function(i){return t[i]||(t[i]=e()),t[i]}}var k=function e(t,i,r,a){var n=this;Object(s.a)(this,e),this.gpu=t,this.gridSize=i,this.cellSize=r,this.reflectiveBoundary=a,this.data=void 0,this.updateMagnetic=void 0,this.updateElectric=void 0,this.injectSource=void 0,this.decaySource=void 0,this.makeFieldTexture=void 0,this.copyTexture=void 0,this.drawOnTexture=void 0,this.kernels=[],this.setGridSize=function(e){n.gridSize=e,n.kernels.forEach((function(t){return t.setOutput(e)}));for(var t=0;t<3;t++)n.data.electricField[t].shape=e,n.data.magneticField[t].shape=e;n.data.permittivity.shape=e,n.data.permeability.shape=e,n.data.permittivity.values=n.copyTexture("permittivity")(n.data.permittivity.values),n.data.permeability.values=n.copyTexture("permeability")(n.data.permeability.values),n.resetFields()},this.setCellSize=function(e){n.cellSize=e,n.resetFields()},this.stepElectric=function(e){var t=n.data.electricField.map((function(e){return e.values})),i=n.data.magneticField.map((function(e){return e.values})),r=n.data.permittivity.values,a=n.injectSource(n.data.electricSourceFieldZ.values,t[2],e);n.data.electricSourceFieldZ.values=n.decaySource(n.copyTexture("es2")(n.data.electricSourceFieldZ.values),e),n.data.electricField[0].values=n.updateElectric[0](i[1],i[2],r,n.copyTexture("e0")(t[0]),e,n.cellSize,n.reflectiveBoundary),n.data.electricField[1].values=n.updateElectric[1](i[0],i[2],r,n.copyTexture("e1")(t[1]),e,n.cellSize,n.reflectiveBoundary),n.data.electricField[2].values=n.updateElectric[2](i[0],i[1],r,a,e,n.cellSize,n.reflectiveBoundary),n.data.time+=e/2},this.stepMagnetic=function(e){var t=n.data.electricField.map((function(e){return e.values})),i=n.data.magneticField.map((function(e){return e.values})),r=n.data.permeability.values;n.data.magneticField[0].values=n.updateMagnetic[0](t[1],t[2],r,n.copyTexture("m0")(i[0]),e,n.cellSize,n.reflectiveBoundary),n.data.magneticField[1].values=n.updateMagnetic[1](t[0],t[2],r,n.copyTexture("m1")(i[1]),e,n.cellSize,n.reflectiveBoundary),n.data.magneticField[2].values=n.updateMagnetic[2](t[0],t[1],r,n.copyTexture("m2")(i[2]),e,n.cellSize,n.reflectiveBoundary),n.data.time+=e/2},this.resetFields=function(){n.data.time=0;for(var e=0;e<3;e++)n.data.electricField[e].values=n.makeFieldTexture("e".concat(e))(0),n.data.magneticField[e].values=n.makeFieldTexture("m".concat(e))(0);n.data.electricSourceFieldZ.values=n.makeFieldTexture("es2")(0)},this.resetMaterials=function(){n.data.permeability.values=n.makeFieldTexture("permeability")(1),n.data.permittivity.values=n.makeFieldTexture("permittivity")(1)},this.drawShape=function(e,t,i,r){var a=n.drawOnTexture[i.drawShape](t),l=n.copyTexture(t)(e.values);switch(i.drawShape){case"square":e.values=a(i.center,i.halfSize,i.value,r,l);break;case"circle":e.values=a(i.center,i.radius,i.value,r,l);break;default:throw Error("Invalid draw shape: ".concat(JSON.stringify(i)))}},this.drawMaterial=function(e,t){var i="permeability"===e?n.data.permeability:n.data.permittivity;n.drawShape(i,e,t,0)},this.injectSignal=function(e,t){n.drawShape(n.data.electricSourceFieldZ,"es2",function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?j(i,!0).forEach((function(t){Object(o.a)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):j(i).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},e,{value:e.value*t}),1)},this.loadPermittivity=function(e){n.data.permittivity.values=n.copyTexture("loadPermittivity")(e)},this.loadPermeability=function(e){n.data.permeability.values=n.copyTexture("loadPermeability")(e)},this.getData=function(){return n.data};var l=function(e){var t=n.gpu.createKernel(e).setOutput(n.gridSize).setWarnVarUsage(!1).setPipeline(!0).setTactic("performance").setDynamicOutput(!0).setDynamicArguments(!0).setPrecision("single");return n.kernels.push(t),t},u=function(e){return l(e).setFunctions([d])},c=function(e){return u(e).setConstants({cellSize:r})};this.makeFieldTexture=z((function(){return l(p)})),this.copyTexture=z((function(){return l(h)}));var M=function(e,t){return{values:n.makeFieldTexture(e)(t),shape:n.gridSize}};this.data={time:0,electricField:[0,1,2].map((function(e){return M("e".concat(e),0)})),magneticField:[0,1,2].map((function(e){return M("m".concat(e),0)})),electricSourceFieldZ:M("es2",0),permittivity:M("permittivity",1),permeability:M("permeability",1)},this.drawOnTexture={square:z((function(){return c(m)})),circle:z((function(){return c(f)}))},this.injectSource=u(b),this.decaySource=u(g),this.updateMagnetic=[c(v),c(y),c(S)],this.updateElectric=[c(O),c(x),c(w)]};var A=function e(t,i,r,a){var n=this;Object(s.a)(this,e),this.amplitude=t,this.frequency=i,this.position=r,this.turnOffTime=a,this.inject=function(e,t){var i=e.getData().time;if(i>=0&&(void 0===n.turnOffTime||i<=n.turnOffTime)){var r=-n.amplitude*Math.cos(2*Math.PI*n.frequency*i),a=M(n.position,1,r);e.injectSignal(a,t)}}};function C(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function F(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?C(i,!0).forEach((function(t){Object(o.a)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):C(i).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function D(e){var t=Object(r.useState)(void 0!==e.initiallyCollapsed&&e.initiallyCollapsed),i=Object(u.a)(t,2),n=i[0],l=i[1];return a.a.createElement("div",{id:e.id,className:e.className,style:F({textAlign:"center",background:"rgb(33, 33, 33)",fontWeight:"lighter",color:"white"},e.style)},a.a.createElement("button",{onClick:function(e){return l(!n)},style:F({width:"100%",height:"24px",background:"rgb(50, 50, 50)",border:"0px",color:"white",fontWeight:"bold",cursor:"pointer"},e.buttonStyle)},e.title?"".concat(e.title," "):"","[",n?"+":"-","]"),!n&&e.children)}function T(e){var t=e.value,i=e.setValue,n=e.allowNegative,l=e.logarithmic,c=e.displayDigits,o=l?Math.log2(Math.abs(t)):Math.abs(t),s=Object(r.useState)(t<0),d=Object(u.a)(s,2),p=d[0],h=d[1],m=Object(r.useRef)(null),f=Object(r.useCallback)((function(){if(m.current){var e=parseFloat(m.current.value);l&&(e=Math.pow(2,e)),i((p?-1:1)*e)}}),[i,p,l,m]);Object(r.useEffect)((function(){return f()}),[p,f]);var b=void 0!==c?t.toFixed(c):t;return a.a.createElement("div",null,a.a.createElement("label",null,e.label),n&&a.a.createElement(a.a.Fragment,null,a.a.createElement("input",{style:{marginLeft:"10px"},type:"checkbox",checked:p,onChange:function(e){return h(e.target.checked)}}),a.a.createElement("label",null,"Negative")),a.a.createElement("div",null,a.a.createElement("input",{type:"range",ref:m,min:e.min,max:e.max,value:o,step:e.step,onChange:f,style:{height:10,width:"100%"}}),a.a.createElement("div",{style:{textAlign:"center",lineHeight:.2,marginBottom:"7px"}},b)))}function B(e){return a.a.createElement("div",{style:e.style},e.options.map((function(t,i){return a.a.createElement("button",{key:t,style:F({backgroundColor:"rgb(50, 50, 50)",color:"white",border:i===e.selectedOption?"3px solid rgb(0, 150, 255)":"0",height:"30px",width:"70px",overflow:"hidden",textOverflow:"hidden"},e.buttonStyle),onClick:function(t){return e.setSelectedOption(i)}},t)})))}function P(e){var t=e.simulator,i=e.gridSize,n=Object(r.useState)(""),l=Object(u.a)(n,2),c=l[0],o=l[1],s=Object(r.useCallback)((function(){if(t){var e=t.getData();window.open(function(e){var t=document.createElement("canvas");t.width=e.shape[0],t.height=e.shape[1];var i=e.permeability,r=e.permittivity,a=t.getContext("2d");a.fillStyle="rgb(1, 0, 1)",a.fillRect(0,0,t.width,t.height),a.fillStyle="rgb(0, 255, 0)",a.textAlign="center",a.textBaseline="middle",a.fillText("warlock.ai/maxwell",t.width/2,t.height/2);for(var n=a.getImageData(0,0,t.width,t.height),l=0;l<t.width;l++)for(var u=0;u<t.height;u++)n.data[4*l+u*t.width*4+0]=Math.round(r[u][l]),n.data[4*l+u*t.width*4+2]=Math.round(i[u][l]),n.data[4*l+u*t.width*4+3]=255;return a.putImageData(n,0,0),t.toDataURL("image/png")}({permittivity:e.permittivity.values.toArray(),permeability:e.permeability.values.toArray(),shape:[e.permeability.shape[0],e.permeability.shape[1]]}))}}),[t]),d=Object(r.useCallback)((function(){t&&function(e,t,i){var r=document.createElement("canvas");r.width=t[0],r.height=t[1];var a=new Image;a.crossOrigin="anonymous",a.onload=function(e){var n=r.getContext("2d");n.fillStyle="rgb(1, 0, 1)",n.fillRect(0,0,r.width,r.height),n.drawImage(a,0,0,a.width,a.height);for(var l={permeability:[],permittivity:[],shape:t},u=n.getImageData(0,0,r.width,r.height).data,c=0;c<t[1];c++){l.permittivity.push([]),l.permeability.push([]);for(var o=0;o<t[0];o++)l.permittivity[c].push(Math.max(1,u[4*o+c*t[0]*4+0])),l.permeability[c].push(Math.max(1,u[4*o+c*t[0]*4+2]))}i(l)},a.src=e}(c,[i[0],i[1]],(function(e){t&&(t.loadPermeability(e.permeability),t.loadPermittivity(e.permittivity))}))}),[t,i,c]);return a.a.createElement("div",{style:{padding:"10px"}},a.a.createElement("div",null,a.a.createElement("button",{onClick:s,style:{background:"rgba(50, 50, 50, 100)",border:"0px",color:"white",margin:"2px"}},"Save map")),a.a.createElement("div",null,a.a.createElement("input",{type:"text",onChange:function(e){return o(e.target.value)},style:{background:"rgba(50, 50, 50, 100)",border:"0px",color:"white",margin:"2px"}}),a.a.createElement("button",{onClick:d,style:{background:"rgba(50, 50, 50, 100)",border:"0px",color:"white",margin:"2px"}},"Load map url")))}function q(e){var t=e.simulator,i=e.setGridSizeLongest,n=e.setDt,l=e.setCellSize,u=e.setSimulationSpeed,c=e.setSources,o=Object(r.useCallback)((function(e){t&&(t.resetFields(),t.loadPermeability(e.materialMap.permeability),t.loadPermittivity(e.materialMap.permittivity));var r=e.sourcesDescriptors.map((function(e){if("point"===e.type)return new A(e.amplitude,e.frequency,e.position,e.turnOffTime);throw new Error("Unsupported source type: ".concat(e.type))}));l(e.simulationSettings.cellSize),n(e.simulationSettings.dt),u(e.simulationSettings.simulationSpeed),i(Math.max(e.simulationSettings.gridSize[0],e.simulationSettings.gridSize[1])),c(r)}),[t,l,n,u,i,c]),s=Object(r.useMemo)((function(){return{dt:e.dt,cellSize:e.cellSize,gridSize:e.gridSize,simulationSpeed:e.simulationSpeed}}),[e.dt,e.cellSize,e.gridSize,e.simulationSpeed]);return a.a.createElement("div",{style:{padding:"10px"}},a.a.createElement("button",{onClick:function(e){return o(function(e){for(var t={permittivity:[],permeability:[],shape:e.gridSize},i=0;i<e.gridSize[1];i++)t.permittivity.push(new Array(e.gridSize[0]).fill(1)),t.permeability.push(new Array(e.gridSize[0]).fill(1));return{sourcesDescriptors:[],simulationSettings:e,materialMap:t}}(s))},style:{backgroundColor:"rgb(50, 50, 50)",border:"0px",color:"white",margin:"2px"}},"Empty"),a.a.createElement("button",{onClick:function(e){return o(function(e){for(var t={permittivity:[],permeability:[],shape:e.gridSize},i=Math.round(.75*e.gridSize[0]),r=.2/e.cellSize,a=0;a<e.gridSize[1];a++){var n=Math.abs(a-e.gridSize[1]/5)<2,l=new Array(e.gridSize[0]).fill(n?100:1);if(n){for(var u=i-2*r;u<i-r;u++)l[u]=1;for(var c=i+2*r;c>i+r;c--)l[c]=1}t.permittivity.push(l),t.permeability.push(new Array(e.gridSize[0]).fill(1))}return{sourcesDescriptors:[{type:"point",amplitude:3e4,frequency:3,position:[Math.round(i),Math.round(e.gridSize[1]/15)]}],simulationSettings:e,materialMap:t}}(s))},style:{backgroundColor:"rgb(50, 50, 50)",border:"0px",color:"white",margin:"2px"}},"Double slit"),a.a.createElement("button",{onClick:function(e){return o(function(e){for(var t={permittivity:[],permeability:[],shape:e.gridSize},i=0;i<e.gridSize[1];i++)t.permittivity.push(new Array(e.gridSize[0]).fill(1)),t.permeability.push(new Array(e.gridSize[0]).fill(1));function r(t){return[Math.round(3*e.gridSize[0]/4+e.gridSize[0]/5*.5/(2*t+1)*-Math.sin(2*Math.PI*t)),Math.round(e.gridSize[1]*(.1+.8*t))]}for(var a=.04/e.cellSize,n=0;n<100;n++)for(var l=r(n/100),u=-a+l[0];u<a+l[0];u++)for(var c=-a+l[1];c<a+l[1];c++)u>=0&&c>=0&&u<e.gridSize[0]&&c<e.gridSize[1]&&(t.permittivity[c][u]=2);var o=r(1);return{sourcesDescriptors:[{type:"point",amplitude:8e3,frequency:5,position:[o[0]-1,o[1]],turnOffTime:.5},{type:"point",amplitude:8e3,frequency:5,position:[o[0]+2,o[1]],turnOffTime:.5}],simulationSettings:e,materialMap:t}}(s))},style:{backgroundColor:"rgb(50, 50, 50)",border:"0px",color:"white",margin:"2px"}},"Fiber optics"),a.a.createElement("button",{onClick:function(e){return o(function(e){var t={permittivity:[],permeability:[],shape:e.gridSize},i=[.6*e.gridSize[0],e.gridSize[1]/2];function r(t){var r=t[0]-i[0],a=t[1]-i[1];return 4*r*r+a*a<e.gridSize[0]*e.gridSize[0]/100}for(var a=0;a<e.gridSize[1];a++){t.permittivity.push([]),t.permeability.push(new Array(e.gridSize[0]).fill(1));for(var n=0;n<e.gridSize[0];n++)t.permittivity[a].push(r([n,a])?3:1)}return{sourcesDescriptors:[{type:"point",amplitude:2e4,frequency:2,position:[Math.round(e.gridSize[0]/10),Math.round(e.gridSize[1]/2)],turnOffTime:.5}],simulationSettings:e,materialMap:t}}(s))},style:{backgroundColor:"rgb(50, 50, 50)",border:"0px",color:"white",margin:"2px"}},"Lens"))}function V(e){var t=e.qualityPresets,i=e.setCellSize,n=e.setGridSizeLongest,l=e.setResolutionScale,u=e.setDt,c=Object(r.useCallback)((function(e){i(e.cellSize),n(e.gridSizeLongest),l(e.resolutionScale),u(e.dt)}),[i,n,l,u]);return a.a.createElement("div",{style:{padding:"10px"}},a.a.createElement("div",null,"Quality presets"),a.a.createElement("div",null,Object.keys(t).map((function(e){return a.a.createElement("button",{key:e,onClick:function(i){return c(t[e])},style:{backgroundColor:"rgb(50, 50, 50)",border:"0px",color:"white",margin:"2px"}},e)}))),a.a.createElement(T,{label:"Grid length",value:e.gridSizeLongest,setValue:e.setGridSizeLongest,min:100,max:2e3,step:100}),a.a.createElement(T,{label:"Time step size",value:e.dt,setValue:e.setDt,min:.001,max:.1,step:.001,allowNegative:!0}),a.a.createElement(T,{label:"Cell size",value:e.cellSize,setValue:e.setCellSize,min:.002,max:.2,step:.001}),a.a.createElement(T,{label:"Resolution scale",value:e.resolutionScale,setValue:e.setResolutionScale,min:.1,max:2,step:.1}),a.a.createElement(T,{label:"Simulation speed",value:e.simulationSpeed,setValue:e.setSimulationSpeed,min:0,max:10,step:.1}),a.a.createElement("input",{type:"checkbox",checked:e.reflectiveBoundary,onChange:function(t){return e.setReflectiveBoundary(t.target.checked)}}),"Reflective boundary")}function L(e){var t=1===e.clickOption,i=e.drawShapeType,n=e.setDrawShapeType,l=Object(r.useMemo)((function(){return"square"===i?0:1}),[i]),u=Object(r.useCallback)((function(e){return n(0===e?"square":"circle")}),[n]),c=Object(r.useMemo)((function(){return"square"===i?"Brush size":"Brush radius"}),[i]);return a.a.createElement("div",{style:{padding:"10px"}},a.a.createElement(B,{buttonStyle:{height:"24px"},options:["Square","Circle"],selectedOption:l,setSelectedOption:u}),a.a.createElement("div",{style:{display:t?void 0:"none"}},a.a.createElement(T,{label:c,value:e.signalBrushSize,setValue:e.setSignalBrushSize,min:1,max:100,step:1}),a.a.createElement(T,{label:"Signal amplitude",value:e.signalBrushValue,setValue:e.setSignalBrushValue,min:1,max:100,step:1}),a.a.createElement(T,{label:"Signal frequency",value:e.signalFrequency,setValue:e.setSignalFrequency,min:0,max:25,step:.25})),a.a.createElement("div",{style:{display:t?"none":void 0}},a.a.createElement(T,{label:c,value:e.materialBrushSize,setValue:e.setMaterialBrushSize,min:1,max:100,step:1}),a.a.createElement(T,{label:"\u03b5 value",value:e.permittivityBrushValue,setValue:e.setPermittivityBrushValue,min:-1,max:10,step:.1,allowNegative:!0,logarithmic:!0,displayDigits:1}),a.a.createElement(T,{label:"\xb5 value",value:e.permeabilityBrushValue,setValue:e.setPermeabilityBrushValue,min:-1,max:10,step:.1,allowNegative:!0,logarithmic:!0,displayDigits:1})),a.a.createElement(B,{style:{margin:"10px"},options:["Material","Signal"],selectedOption:e.clickOption,setSelectedOption:e.setClickOption}),a.a.createElement("div",null,a.a.createElement("button",{onClick:e.resetFields,style:{backgroundColor:"rgb(50, 50, 50)",border:"0px",color:"white",margin:"2px",width:"130px"}},"Reset fields"),a.a.createElement("button",{onClick:e.resetMaterials,style:{backgroundColor:"rgb(50, 50, 50)",border:"0px",color:"white",margin:"2px",width:"130px"}},"Reset materials")))}function R(){document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():document.documentElement.requestFullscreen()}function U(e,t,i){return Math.max(e,Math.min(t,i))}var G=i(75),I=i.n(G);i(183);function W(e,t,i,r,a){return r<0||r>=t||a<0||a>=i?0:e[a][r]}function Y(e,t,i,r,a,n,l,u,c,o){var s=c[0],d=c[1],p=s*this.thread.x/this.output.x,h=d*(1-this.thread.y/this.output.y),m=4e-4/(o*o),f=W(e,s,d,p,h),b=W(t,s,d,p,h),g=W(i,s,d,p,h),v=m*m*(f*f+b*b+g*g),y=W(r,s,d,p-.5,h-.5),S=W(a,s,d,p-.5,h-.5),O=W(n,s,d,p-.5,h-.5),x=m*m*(y*y+S*S+O*O),w=2/(1+Math.exp(-.4*W(l,s,d,p,h)))-1,j=2/(1+Math.exp(-.4*W(u,s,d,p,h)))-1,M=Math.max(1,c[0]/this.output.x),E=Math.max(1,c[1]/this.output.y),z=(Math.abs(M*p%1-.5)<.25?1:0)*(Math.abs(E*h%1-.5)<.25?1:0),k=1-z;this.color(Math.min(1,v+.8*z*w),Math.min(1,v+x),Math.min(1,x+.8*k*j))}function N(e,t,i,r,a,n,l,u,c){var o=c[0],s=c[1],d=o*this.thread.x/this.output.x,p=s*(1-this.thread.y/this.output.y),h=Math.round(d),m=Math.round(p),f=W(e,o,s,h,m)*W(e,o,s,h,m)+W(t,o,s,h,m)*W(t,o,s,h,m)+W(i,o,s,h,m)*W(i,o,s,h,m),b=W(r,o,s,h,m),g=W(a,o,s,h,m),v=W(n,o,s,h,m),y=b*b+g*g+v*v,S=2/(1+Math.exp(-.4*W(l,o,s,h,m)))-1,O=2/(1+Math.exp(-.4*W(u,o,s,h,m)))-1,x=Math.max(1,c[0]/this.output.x),w=Math.max(1,c[1]/this.output.y),j=(Math.abs(x*d%1-.5)<.25?1:0)*(Math.abs(w*p%1-.5)<.25?1:0),M=1-j;this.color(Math.min(1,f/15+.8*j*S),Math.min(1,f/15+y/15),Math.min(1,y/15+.8*M*O))}var X={Low:{dt:.026,cellSize:.04,resolutionScale:.3,gridSizeLongest:200},Medium:{dt:.013,cellSize:.02,resolutionScale:1,gridSizeLongest:400},High:{dt:.0065,cellSize:.01,resolutionScale:1,gridSizeLongest:800},Ultra:{dt:.00325,cellSize:.005,resolutionScale:1,gridSizeLongest:1600}},K=function(){if(c.GPU.isSinglePrecisionSupported){if(c.GPU.isWebGL2Supported)return"webgl2";if(c.GPU.isWebGLSupported)return"webgl"}return"cpu"}();console.log("Using GPU mode ".concat(K));var Q="cpu"===K?X.Low:X.Medium,Z="cpu"===K?1:3,H=Q.dt,J=Q.cellSize,_=Q.gridSizeLongest,$=Q.resolutionScale,ee=[window.innerWidth,window.innerHeight],te=re(ee,$),ie=ae(_,te);function re(e,t){return[Math.round(e[0]*t),Math.round(e[1]*t)]}function ae(e,t){var i=t[0]/t[1];return t[0]>=t[1]?[e,Math.ceil(e/i)]:[Math.ceil(e*i),e]}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(a.a.createElement((function(){var e=Object(r.useRef)(null),t=Object(r.useState)(te),i=Object(u.a)(t,2),n=i[0],l=i[1],o=Object(r.useState)(ee),s=Object(u.a)(o,2),d=s[0],p=s[1],h=Object(r.useState)(_),m=Object(u.a)(h,2),f=m[0],b=m[1],g=Object(r.useState)(H),v=Object(u.a)(g,2),y=v[0],S=v[1],O=Object(r.useState)(J),x=Object(u.a)(O,2),w=x[0],j=x[1],z=Object(r.useState)($),A=Object(u.a)(z,2),C=A[0],F=A[1],T=Object(r.useState)(1),B=Object(u.a)(T,2),G=B[0],Q=B[1],ne=Object(r.useState)(!1),le=Object(u.a)(ne,2),ue=le[0],ce=le[1],oe=Object(r.useState)([]),se=Object(u.a)(oe,2),de=se[0],pe=se[1];Object(r.useEffect)((function(){var e=function(){var e=[window.innerWidth,window.innerHeight];l(re(e,C)),p(e)};return e(),window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[C]);var he=Object(r.useMemo)((function(){return ae(f,n)}),[n,f]),me=Object(r.useState)(null),fe=Object(u.a)(me,2),be=fe[0],ge=fe[1];Object(r.useEffect)((function(){e.current&&ge(new c.GPU({mode:K,canvas:e.current}))}),[e]);var ve=Object(r.useMemo)((function(){return be?new k(be,ie,J,!1):null}),[be]),ye=Object(r.useMemo)((function(){return be?function(e,t){return("cpu"!==K?e.createKernel(Y):e.createKernel(N)).setOutput(t).setGraphical(!0).setFunctions([W]).setWarnVarUsage(!1).setTactic("performance").setPrecision("unsigned").setDynamicOutput(!0).setDynamicArguments(!0)}(be,ie):null}),[be]);Object(r.useEffect)((function(){ye&&ye.setOutput(n)}),[ye,n]),Object(r.useEffect)((function(){ve&&ve.setGridSize(he)}),[ve,he]),Object(r.useEffect)((function(){ve&&ve.setCellSize(w)}),[ve,w]),Object(r.useEffect)((function(){ve&&(ve.reflectiveBoundary=ue)}),[ve,ue]);var Se=Object(r.useState)(1),Oe=Object(u.a)(Se,2),xe=Oe[0],we=Oe[1],je=Object(r.useState)(10),Me=Object(u.a)(je,2),Ee=Me[0],ze=Me[1],ke=Object(r.useState)("square"),Ae=Object(u.a)(ke,2),Ce=Ae[0],Fe=Ae[1],De=Object(r.useState)(5),Te=Object(u.a)(De,2),Be=Te[0],Pe=Te[1],qe=Object(r.useState)(5),Ve=Object(u.a)(qe,2),Le=Ve[0],Re=Ve[1],Ue=Object(r.useState)(1),Ge=Object(u.a)(Ue,2),Ie=Ge[0],We=Ge[1],Ye=Object(r.useState)(Z),Ne=Object(u.a)(Ye,2),Xe=Ne[0],Ke=Ne[1],Qe=Object(r.useState)(!1),Ze=Object(u.a)(Qe,2),He=Ze[0],Je=Ze[1],_e=Object(r.useState)(1),$e=Object(u.a)(_e,2),et=$e[0],tt=$e[1],it=Object(r.useState)(null),rt=Object(u.a)(it,2),at=rt[0],nt=rt[1],lt=Object(r.useRef)(0),ut=Object(r.useRef)(null),ct=Object(r.useMemo)((function(){return function(e){return[U(0,he[0]-1,Math.floor(he[0]*e[0]/d[0])),U(0,he[1]-1,Math.floor(he[1]*e[1]/d[1]))]}}),[d,he]),ot=Object(r.useCallback)((function(){if(ve){var e=ve.getData();if(null!==ut.current){var t=ct(ut.current),i=Math.round(xe/2),r=2e3*-Ee*Math.cos(2*Math.PI*Xe*e.time),a="square"===Ce?M(t,i,r):E(t,i,r);ve.injectSignal(a,y)}var n=!0,l=!1,u=void 0;try{for(var c,o=de[Symbol.iterator]();!(n=(c=o.next()).done);n=!0){c.value.inject(ve,y)}}catch(s){l=!0,u=s}finally{try{n||null==o.return||o.return()}finally{if(l)throw u}}ve.stepMagnetic(y),ve.stepElectric(y)}}),[ve,y,Xe,Ee,xe,de,ct,Ce]);Object(r.useEffect)((function(){if(G>0){var e=setInterval(ot,1e3/G*y);return function(){return clearInterval(e)}}}),[ot,y,G]);var st=Object(r.useCallback)((function(){if(ve&&ye){if(e.current){var t=re([window.innerWidth,window.innerHeight],C);e.current.width=t[0],e.current.height=t[1]}var i=ve.getData();ye(i.electricField[0].values,i.electricField[1].values,i.electricField[2].values,i.magneticField[0].values,i.magneticField[1].values,i.magneticField[2].values,i.permittivity.values,i.permeability.values,he,w)}}),[ve,ye,he,w,C,e]);Object(r.useEffect)((function(){var e=!1;return requestAnimationFrame((function t(){e||(st(),requestAnimationFrame(t))})),function(){e=!0}}),[st]);var dt=Object(r.useCallback)((function(e){if(ve){var t=[Math.round(he[0]*(e[0]/d[0])),Math.round(he[1]*(e[1]/d[1]))],i=Math.round(Be/2);ve.drawMaterial("permittivity","square"===Ce?M(t,i,Le):E(t,i,Le)),ve.drawMaterial("permeability","square"===Ce?M(t,i,Ie):E(t,i,Ie))}}),[ve,he,d,Be,Le,Ie,Ce]),pt=Object(r.useCallback)((function(){ve&&ve.resetMaterials()}),[ve]),ht=Object(r.useCallback)((function(){ve&&(ve.resetFields(),lt.current=0)}),[ve]),mt=Object(r.useCallback)((function(e){var t=Object(u.a)(e,2),i=t[0],r=t[1];ve&&(1===et?ut.current=[i,r]:0===et&&(dt([i,r]),Je(!0)))}),[ve,dt,et]),ft=Object(r.useCallback)((function(e){var t=Object(u.a)(e,2),i=t[0],r=t[1];ve&&(1===et&&null!==ut.current&&(ut.current=[i,r]),He&&dt([i,r]))}),[ve,dt,et,He]),bt=Object(r.useCallback)((function(){1===et?ut.current=null:0===et&&Je(!1)}),[et]),gt=Object(r.useMemo)((function(){return(1===et?xe:Be)*(n[0]/he[0])}),[et,xe,Be,n,he]);return a.a.createElement("div",{style:{touchAction:"none",userSelect:"none"}},a.a.createElement("canvas",{width:n[0],height:n[1],ref:e,style:{position:"absolute",width:d[0],height:d[1]},onMouseDown:function(e){return mt([e.clientX,e.clientY])},onMouseMove:function(e){nt([e.clientX,e.clientY]),ft([e.clientX,e.clientY])},onMouseUp:function(e){return bt()},onMouseLeave:function(e){return bt()},onTouchStart:function(e){nt([e.touches[0].clientX,e.touches[0].clientY]),mt([e.touches[0].clientX,e.touches[0].clientY])},onTouchMove:function(e){nt([e.touches[0].clientX,e.touches[0].clientY]),ft([e.touches[0].clientX,e.touches[0].clientY])},onTouchEnd:function(e){nt(null),bt()},onTouchCancel:function(e){nt(null),bt()},onContextMenu:function(e){return e.preventDefault()}}),a.a.createElement("div",{style:{position:"absolute",bottom:10,right:10}},a.a.createElement("a",{href:"mailto:tora@warlock.ai?subject=EM simulation feedback",rel:"noopener noreferrer",target:"_blank",style:{fontWeight:"lighter",color:"rgba(255, 255, 255, 100)",textDecoration:"none",marginRight:"8px"}},"Feedback"),a.a.createElement("a",{href:"https://github.com/RobinKa/maxwell-simulation",rel:"noopener noreferrer",target:"_blank",style:{fontWeight:"lighter",color:"rgba(255, 255, 255, 100)",textDecoration:"none"}},"Source code")),at&&("square"===Ce?a.a.createElement("div",{style:{position:"absolute",pointerEvents:"none",left:at[0]-gt/2,top:at[1]-gt/2,width:gt,height:gt,border:"2px solid yellow"}}):a.a.createElement("div",{style:{position:"absolute",pointerEvents:"none",left:at[0]-gt/2,top:at[1]-gt/2,width:gt,height:gt,border:"2px solid yellow",borderRadius:"50%"}})),"cpu"===K&&a.a.createElement("div",{style:{position:"absolute",pointerEvents:"none",left:10,bottom:10,color:"red",fontWeight:"lighter"}},"Using CPU (WebGL with float textures unsupported by your device)"),a.a.createElement("img",{onClick:R,src:I.a,alt:"Fullscreen",style:{position:"absolute",right:10,top:10,cursor:"pointer"}}),a.a.createElement(D,{id:"Menu",title:"Menu",buttonStyle:{background:"rgb(60, 60, 60)"}},a.a.createElement(D,{title:"Examples"},a.a.createElement(q,{simulator:ve,setCellSize:j,setDt:S,setGridSizeLongest:b,setSimulationSpeed:Q,setSources:pe,gridSize:he,dt:y,cellSize:w,simulationSpeed:G})),a.a.createElement(D,{title:"Controls"},a.a.createElement(L,{signalBrushSize:xe,setSignalBrushSize:we,materialBrushSize:Be,setMaterialBrushSize:Pe,signalBrushValue:Ee,setSignalBrushValue:ze,permittivityBrushValue:Le,setPermittivityBrushValue:Re,permeabilityBrushValue:Ie,setPermeabilityBrushValue:We,signalFrequency:Xe,setSignalFrequency:Ke,clickOption:et,setClickOption:tt,drawShapeType:Ce,setDrawShapeType:Fe,resetFields:ht,resetMaterials:pt})),a.a.createElement(D,{title:"Save / Load",initiallyCollapsed:!0},a.a.createElement(P,{simulator:ve,gridSize:he})),a.a.createElement(D,{title:"Settings",initiallyCollapsed:!0},a.a.createElement(V,{gridSizeLongest:f,setGridSizeLongest:b,simulationSpeed:G,setSimulationSpeed:Q,resolutionScale:C,setResolutionScale:F,cellSize:w,setCellSize:j,reflectiveBoundary:ue,setReflectiveBoundary:ce,dt:y,setDt:S,qualityPresets:X}))))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},75:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABISURBVFhH7dchDgAhDETRKfe/M1TUlgyqgv8Mq+AnQMjGTjJFqs+rlzlXjWMIIKC9Be6Jd3XrsAUEAAB4jgkYD+DPiIDfA6QD/j8gGcpVf+MAAAAASUVORK5CYII="},76:function(e,t,i){e.exports=i(184)},81:function(e,t,i){}},[[76,1,2]]]);
//# sourceMappingURL=main.ca293309.chunk.js.map